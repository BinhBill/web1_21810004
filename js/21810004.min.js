const API="https://web1-api.vercel.app/api",AUTHENTICATION_API="https://web1-api.vercel.app/users",siteKey="6Lea2bcpAAAAAArBqKF1mP8v0lCpOhivhL9JnPZz";async function loadData(request,templateId,viewId){const response=await fetch(`${API}/${request}`),data=await response.json();var template=Handlebars.templates[`${templateId}`],context={data:data},view;document.getElementById(viewId).innerHTML=template(context)}async function login(e){e.preventDefault();let username=document.getElementById("username").value,password=document.getElementById("password").value;document.getElementById("errorMessage").innerHTML="";try{let token=await getAuthenticateToken(username,password);token&&(localStorage.setItem("token",token),document.getElementsByClassName("btn-close")[0].click(),displayControls())}catch(error){document.getElementById("errorMessage").innerHTML=error,displayControls(!1)}}async function getAuthenticateToken(username,password){let response=await fetch(`${AUTHENTICATION_API}/authenticate`,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({username:username,password:password})}),result=await response.json();if(200==response.status)return result.token;throw new Error(result.message)}function displayControls(isLogin=!0){let linkLogins=document.getElementsByClassName("linkLogin"),linkLogouts=document.getElementsByClassName("linkLogout"),displayLogin="none",displayLogout="block";isLogin||(displayLogin="block",displayLogout="none");for(let i=0;i<2;i++)linkLogins[i].style.display=displayLogin,linkLogouts[i].style.display=displayLogout;let commentControl=document.getElementById("leave-comments");commentControl&&(commentControl.style.display=displayLogout)}async function checkLogin(){let isLogin;displayControls(await verifyToken())}async function verifyToken(){let token=localStorage.getItem("token");if(token){let response;if(200==(await fetch(`${AUTHENTICATION_API}/verify`,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:"Bearer "+token}})).status)return!0}return!1}function logout(){localStorage.clear(),displayControls(!1)}